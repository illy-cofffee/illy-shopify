<script src="{{ 'section-glide.js' | asset_url }}"></script>
{{ 'section-glide.core.css' | asset_url | stylesheet_tag }}
{{ 'section-glide-theme.css' | asset_url | stylesheet_tag }}

{%- if section.blocks.size > 0 -%}

    <!-- if there is more than one i  tem in the carousel, turn on the navigation and the auto rotate -->
    <div id="glide-carousel-{{ section.id }}" class="glide">

      <div class="glide__track" data-glide-el="track">
        <ul class="glide__slides">
          
{%- for block in section.blocks -%}
          <!-- build out each carousel item (block) -->
          <li class="glide__slide" id="element-{{ block.id }}" style="
            {% if block.settings.color_background_main != "" %}
              background-color:{{ block.settings.color_background_main }};
            {% endif %}
            "> 
            {% if block.settings.column_layout == "one_column" or block.settings.column_layout == "full_width" %}
              <div class="slider-content {% if block.settings.column_layout == "one_column" %}contained{% endif %}" aria-hidden="true">  
                <div class="slider-column-single {{ block.settings.alignment }} {% if block.settings.column_layout == "one_column" %}mobile-one-col{% else %}mobile-full-width{% endif %}">
                  <div class="slider-column-content" {% unless block.settings.color_text_main == blank -%}
                    style="color: {{ block.settings.color_text_main }}"
                  {% endunless %}>
                    <!-- Test content -->
                    
                  {%- unless block.settings.outline_text == blank -%}
    
                    <span class="text-size--small">{{ block.settings.outline_text | escape }}</span>
                  
                  {%- endunless -%}
    
                  {%- unless block.settings.glide-slider-item-header == blank -%}
                  {% assign blockheader = block.settings.glide-slider-item-header %}
                  {% assign blockheader = blockheader | remove: "<p>" %}
                  {% assign blockheader = blockheader | remove: "</p>" %}
    
                  {% if section.settings.h1-title == true %} 
    
                                <h1 {% else %} <h3 {% endif %}>
                                <span class="text-animation--underline underline-mobile">{{ blockheader }}</span>
                                
                  {% if section.settings.h1-title == true %} </h1> {% else %} </h3>{% endif %}
    
                  {%- endunless -%}
                  {%- unless block.settings.description == blank -%}
                                
                                <span>{{ block.settings.description }}</span>
                              
                  {%- endunless -%}
                  {%- if block.settings.button_label != blank -%}
    
                    <div class="banner__buttons">
                        {%- if block.settings.button_label != blank -%}
                            <a
                            {% if block.settings.button_link_1 == blank %}
                                role="link" aria-disabled="true"
                            {% else %}
                                href="{{ block.settings.button_link }}"
                            {% endif %}
                            class="button{% if block.settings.button_style == "secondary" %} button--secondary{% else %} button--primary{% endif %}"
                            >
                            {{- block.settings.button_label | escape -}}
                            </a>
                        {%- endif -%}
                    </div>

                    {% comment %} <div>
                        
                      {%- render 'button', label: block.settings.button_label, link: block.settings.link, style: block.settings.button_style, fullwidth: false -%}
                    </div> {% endcomment %}
    
      {%- endif -%}
                  </div> <!-- end slider-column-content -->
    
                  {%- capture sizes -%}
                    sizes="(max-width: 1023px) calc({{ block.settings.mobile_height }} * {{ block.settings.image.aspect_ratio }}), calc({{ block.settings.desktop_height }} * {{ block.settings.image.aspect_ratio }})"
                  {%- endcapture -%}
                  
                  {%- liquid
                  
                    assign image_class = 'lazy-image--to-reveal'
                  
                    if block.settings.mobile_image
                  
                      render 'lazy-image', image: block.settings.mobile_image, type: 'background', alt: block.settings.title, image_alignment: true, sizes: sizes, class: 'lazy-image--to-reveal element--hide-on-desk', overlay: true
                  
                      assign image_class = image_class | append: ' element--hide-on-small'
                  
                    endif
                  
                    render 'lazy-image', image: block.settings.image, type: 'background', alt: block.settings.title, image_alignment: true, sizes: sizes, class: image_class, overlay: true, image_class: 'img-top-left'
                  
                  -%}
                  </div><!-- end slider-image -->
    
                  
                </div> <!-- end slider-column-single -->
    
              {% elsif block.settings.column_layout == "two_columns" or block.settings.column_layout == "three_columns" %}
    
            <div class="slider-content contained">
              <div class="{% if block.settings.column_layout == "two_columns" %} slider-column-left {% elsif block.settings.column_layout == "three_columns" %} slider-column-left-three {% endif %} {{ block.settings.alignment }}">
                <div class="slider-column-content" {% unless block.settings.color_text_main == blank -%}
                  style="color: {{ block.settings.color_text_main }}"
                {% endunless %}>
                  <!-- Test content -->
                  
    {%- unless block.settings.outline_text == blank -%}
    
                  <span class="text-size--small">{{ block.settings.outline_text | escape }}</span>
                
    {%- endunless -%}
    
    {%- unless block.settings.glide-slider-item-header == blank -%}
    {% assign blockheader = block.settings.glide-slider-item-header %}
    {% assign blockheader = blockheader | remove: "<p>" %}
    {% assign blockheader = blockheader | remove: "</p>" %}
    {% assign blockheader = blockheader | replace: "<em>", "<span class='em-spectral'>" %}
    {% assign blockheader = blockheader | replace: "</em>", "</span>" %}
    
    {% if section.settings.h1-title == true %} 
    
                  <h1 {% else %} <h3 {% endif %}>
                  <span class="text-animation--underline underline-mobile">{{ blockheader }}</span>
                  
    {% if section.settings.h1-title == true %} </h1> {% else %} </h3>{% endif %}
    
    {%- endunless -%}
    {%- unless block.settings.description == blank -%}
                  
                  <span>{{ block.settings.description }}</span>
                
    {%- endunless -%}
    {%- if block.settings.button_label != blank -%}
    
        <div class="banner__buttons">
            {%- if block.settings.button_label != blank -%}
                <a
                {% if block.settings.button_link_1 == blank %}
                    role="link" aria-disabled="true"
                {% else %}
                    href="{{ block.settings.button_link }}"
                {% endif %}
                class="button{% if block.settings.button_style == "secondary" %} button--secondary{% else %} button--primary{% endif %}"
                >
                {{- block.settings.button_label | escape -}}
                </a>
            {%- endif -%}
        </div>
                  {% comment %} <div>
                    {%- render 'button', label: block.settings.button_label, link: block.settings.link, style: block.settings.button_style, fullwidth: false -%}
                  </div> {% endcomment %}
    
    {%- endif -%}
    
                </div> <!-- end slider-column-content -->
            </div><!-- end slider-column-left -->
          {% if block.settings.column_layout == "two_columns" or block.settings.column_layout == "three_columns" %}
            {% if block.settings.column_layout == "three_columns" %}
              <div class="slider-column-center-three">
                <div class="slider-image" aria-hidden="true">
    
                  {%- capture sizes -%}
                    sizes="(max-width: 1023px) calc({{ section.settings.mobile_height }} * {{ block.settings.image.aspect_ratio }}), calc({{ section.settings.desktop_height }} * {{ block.settings.image.aspect_ratio }})"
                  {%- endcapture -%}
                  
                  {%- liquid
                  
                    assign image_class = 'lazy-image--to-reveal'
                  
                    if block.settings.mobile_image_second
                  
                      render 'lazy-image', image: block.settings.mobile_image_second, type: 'background', alt: block.settings.title, image_alignment: true, sizes: sizes, class: 'lazy-image--to-reveal element--hide-on-desk', overlay: true
                  
                      assign image_class = image_class | append: ' element--hide-on-small'
                  
                    endif
                  
                    render 'lazy-image', image: block.settings.image_second, type: 'background', alt: block.settings.title, image_alignment: true, sizes: sizes, class: image_class, overlay: true, image_class: 'img-top-left'
                  
                  -%}
                            </div><!-- end slider-image -->
              </div><!-- end slider-column-center -->
            {% endif %}        
            <!-- start slider-column-right -->
            <div class="{% if block.settings.column_layout == "two_columns" %} slider-column-right {% elsif block.settings.column_layout == "three_columns" %} slider-column-right-three {% endif %}">
              <div class="slider-image" aria-hidden="true">
    
    {%- capture sizes -%}
      sizes="(max-width: 1023px) calc({{ section.settings.mobile_height }} * {{ block.settings.image.aspect_ratio }}), calc({{ section.settings.desktop_height }} * {{ block.settings.image.aspect_ratio }})"
    {%- endcapture -%}
    
    {%- liquid
    
      assign image_class = 'lazy-image--to-reveal'
    
      if block.settings.mobile_image
    
        render 'lazy-image', image: block.settings.mobile_image, type: 'background', alt: block.settings.title, image_alignment: true, sizes: sizes, class: 'lazy-image--to-reveal element--hide-on-desk', overlay: true
    
        assign image_class = image_class | append: ' element--hide-on-small'
    
      endif
    
      render 'lazy-image', image: block.settings.image, type: 'background', alt: block.settings.title, image_alignment: true, sizes: sizes, class: image_class, overlay: true, image_class: 'img-top-left'
    
    -%}
              </div><!-- end slider-image -->
              
            </div><!-- end slider-column-right -->
          {% endif %}
          </div><!-- end slider-content -->
        {% endif %}
          {% if block.settings.sticker_image != blank %}
            <div class="sticker-image"><img src="{{ block.settings.sticker_image | image_url }}" style="max-width:180px">
              </div>
          {% endif %}


          </li><!-- end slider-item -->

{% endfor %}

        </ul><!-- end slides -->
      </div><!-- end guide-track -->
      <div class="glide__arrows" data-glide-el="controls">
        <button class="glide__arrow glide__arrow--left" data-glide-dir="<"></button>
        <button class="glide__arrow glide__arrow--right" data-glide-dir=">"></button>
      </div>
      <div class="glide__bullets" data-glide-el="controls[nav]">    
      {% if section.blocks.size > 0 %}
        {% assign blockcount = 0 %}
        {%- for block in section.blocks -%}
        <button class="glide__bullet" data-glide-dir="={{ blockcount }}"></button>
        {% assign blockcount = blockcount | plus: 1 %}
        {% endfor %}
      {% endif %}

      </div>
    </div>
{% endif %}
 

{% schema %}
{
  "name": "Glide Slider",
  "max_blocks": 3,
  "settings": [
    {
      "type": "checkbox",
      "id": "h1-title",
      "label": "Should the title be an H1? Check this box.",
      "default": false
    }
  ],
  "blocks": [
    {
      "type": "glide-slider-item",
      "name": "Slider Item",
      "settings": [
        {
          "id": "glide-slider-item-header",
          "type": "richtext",
          "label": "Please enter large heading, use italic on selected words for emphasis",
          "default": "<p>Enter header...</p>"
        },
        {
          "type": "select",
          "id": "column_layout",
          "label": "Column layout",
          "options": [
            {
              "value": "full_width",
              "label": "Full Width"
            },
            {
              "value": "one_column",
              "label": "One Column"
            },
            {
              "value": "two_columns",
              "label": "Two Columns"
            },
            {
              "value": "three_columns",
              "label": "Three Columns"
            }
          ],
          "default": "two_columns"
        },
        {
          "id": "image",
          "type": "image_picker",
          "label": "Desktop Image"
        },
        {
          "id": "mobile_image",
          "type": "image_picker",
          "label": "Mobile Image"
        },
        {
          "id": "image_second",
          "type": "image_picker",
          "label": "Second Desktop Image"
        },
        {
          "id": "mobile_image_second",
          "type": "image_picker",
          "label": "Second Mobile Image"
        },
        {
          "id": "sticker_image",
          "type": "image_picker",
          "label": "Sticker Image"
        },
        {
          "type": "header",
          "content": "Text Content"
        },
        {
          "type": "text",
          "id": "outline_text",
          "label": "Outline text",
          "default": "Introducing"
        },
        {
          "type": "richtext",
          "id": "description",
          "label": "Description text"
        },
        {
          "type": "header",
          "content": "Text Style"
        },
        {
          "type": "select",
          "id": "alignment",
          "label": "Alignment",
          "options": [
            {
              "value": "align-top-left",
              "label": "Left Top"
            },
            {
              "value": "align-top-center",
              "label": "Centre / Top"
            },
            {
              "value": "align-top-right",
              "label": "Right / Top"
            },
            {
              "value": "align-middle-left",
              "label": "Left / Middle"
            },
            {
              "value": "align-middle-center",
              "label": "Centre / Middle"
            },
            {
              "value": "align-middle-right",
              "label": "Right / Middle"
            },
            {
              "value": "align-bottom-left",
              "label": "Left / Bottom"
            },
            {
              "value": "align-bottom-center",
              "label": "Centre / Bottom"
            },
            {
              "value": "align-bottom-right",
              "label": "Right / Bottom"
            }
          ],
          "default": "align-top-left"
        },
        {
          "type": "header",
          "content": "CTAs"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Button Link"
        },
        {
          "type": "text",
          "id": "button_label",
          "label": "Button Text",
          "default": "Show more"
        },
        {
          "id": "button_style",
          "label": "Button Style",
          "type": "select",
          "options": [
            {
              "value": "outline",
              "label": "Outline"
            },
            {
              "value": "solid",
              "label": "Solid"
            },
            {
              "value": "light",
              "label": "Light"
            }
          ],
          "default": "solid"
        },
        {
          "type": "header",
          "content": "Custom Colours"
        },
        {
          "type": "color",
          "id": "color_background_main",
          "label": "Main background colour",
          "default": "#f75828"
        },
        {
          "type": "color",
          "id": "color_text_main",
          "label": "Main text colour",
          "default": "#333333"
        }
      ]
    }
  ],
  "presets": [
		{
			"name": "Glide Slider",
			"category": "Sliders"
		}
	]
}
{% endschema %}

<script type="text/javascript">
window.addEventListener('load', function () {
  new Glide('.glide', {
    type: 'carousel',
    gap: 0,
    startAt: 0,
    perView: 1,
    autoplay: 5000,    
    animationDuration: 1500
  }).mount()
});
</script>